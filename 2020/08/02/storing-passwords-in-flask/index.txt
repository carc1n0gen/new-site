1:HL["/_next/static/css/4c3ba0c712eb50f7.css",{"as":"style"}]
0:["HVOfH4A8LqJ-k-QTXKGTD",[[["",{"children":[["year","2020","d"],{"children":[["month","08","d"],{"children":[["day","02","d"],{"children":[["slug","storing-passwords-in-flask","d"],{"children":["__PAGE__?{\"year\":\"2020\",\"month\":\"08\",\"day\":\"02\",\"slug\":\"storing-passwords-in-flask\"}",{}]}]}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/4c3ba0c712eb50f7.css","precedence":"next"}]],["$L3",null]]]]]
4:I{"id":7095,"chunks":["95:static/chunks/95-b42e21927908bec6.js","224:static/chunks/224-45995354792692c9.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-fd3e7a5daa90e646.js"],"name":"","async":false}
5:I{"id":7289,"chunks":["95:static/chunks/95-b42e21927908bec6.js","185:static/chunks/app/layout-3babe0f43a2270ad.js"],"name":"","async":false}
6:I{"id":9180,"chunks":["272:static/chunks/webpack-a2ef0b461975a909.js","253:static/chunks/bce60fc1-3d7875a7a6202410.js","698:static/chunks/698-4595f783858dddc6.js"],"name":"default","async":false}
7:I{"id":2306,"chunks":["272:static/chunks/webpack-a2ef0b461975a909.js","253:static/chunks/bce60fc1-3d7875a7a6202410.js","698:static/chunks/698-4595f783858dddc6.js"],"name":"default","async":false}
2:[["$","html",null,{"lang":"en","className":"dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800","children":["$","body",null,{"className":"text-zinc-700 dark:text-zinc-300","children":[["$","header",null,{"className":"bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600","children":[["$","div",null,{"className":"md:max-w-screen-md px-2 md:px-0 mx-auto","children":[["$","img",null,{"src":"/img/avatar-new.jpg","alt":"Avatar photo","className":"rounded-full mx-auto md:float-right md:-mt-4","width":"100","height":"100"}],["$","div",null,{"className":"mt-5","children":[["$","$L4",null,{"href":"/","className":"mt-2","children":["$","h1",null,{"className":"text-5xl font-bold","children":"Carson's Blog"}]}],["$","p",null,{"className":"mt-2","children":"Somewhat coherent tutorials about web stuff and things."}]]}]]}],["$","$L5",null,{}]]}],["$","main",null,{"className":"px-4 py-2 md:p-0 md:max-w-screen-md mx-auto","children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":["$","section",null,{"className":"mt-6 p-6 bg-white border border-zinc-300","children":[["$","h1",null,{"className":"font-bold text-3xl mb-4","children":"Not Found"}],["$","p",null,{"children":"Are you lost? There doesn't seem to be anything here"}]]}],"notFoundStyles":[],"childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2020","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2020","d"],"children",["month","08","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2020","d"],"children",["month","08","d"],"children",["day","02","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2020","d"],"children",["month","08","d"],"children",["day","02","d"],"children",["slug","storing-passwords-in-flask","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8",null],"segment":"__PAGE__?{\"year\":\"2020\",\"month\":\"08\",\"day\":\"02\",\"slug\":\"storing-passwords-in-flask\"}"},"styles":[]}],"segment":["slug","storing-passwords-in-flask","d"]},"styles":[]}],"segment":["day","02","d"]},"styles":[]}],"segment":["month","08","d"]},"styles":[]}],"segment":["year","2020","d"]},"styles":[]}]}],["$","footer",null,{"className":"mt-6 mb-4 text-center","children":"© Carson Evans"}]]}]}],null]
3:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Storing Passwords In Flask - Carson's Blog"}],["$","meta","2",{"name":"description","content":"There is a plethora of guides out there about how to securely store passwords, but there are not as many of those guides that apply to Flask specifically. I spend quite a bit of my free time on the Pallets discord helping people out with their Flask questions, and often enough we have people storing passwords as plain text. So I thought I would write about the different options one has for correctly storing passwords in a Flask app."}],["$","meta","3",{"name":"keywords","content":"password hashing flask security"}],["$","meta","4",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","5",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]]
b:I{"id":4368,"chunks":["95:static/chunks/95-b42e21927908bec6.js","224:static/chunks/224-45995354792692c9.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-fd3e7a5daa90e646.js"],"name":"","async":false}
9:T9d6,<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/signup&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">signup</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:
        username = request.form.get(<span class="hljs-string">&#x27;username&#x27;</span>)
        password = request.form.get(<span class="hljs-string">&#x27;password&#x27;</span>)
        <span class="hljs-keyword">if</span> username <span class="hljs-keyword">and</span> password:
            <span class="hljs-comment"># Hash the password when inserting a new user</span>
            insert_user(username, generate_password_hash(password))
            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;signin&#x27;</span>))
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;signup.html&#x27;</span>)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/signin&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">signin</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:
        username = request.form.get(<span class="hljs-string">&#x27;username&#x27;</span>)
        password = request.form.get(<span class="hljs-string">&#x27;password&#x27;</span>)
        user = get_user(username)
        <span class="hljs-comment"># Check that a user matching the username exists, and that the password matches</span>
        <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> check_password_hash(user.password, password):
            session[<span class="hljs-string">&#x27;user_id&#x27;</span>] = user.<span class="hljs-built_in">id</span>
            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;dashboard&#x27;</span>))
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;signin.html&#x27;</span>)a:Ta74,<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/signup&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">signup</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:
        username = request.form.get(<span class="hljs-string">&#x27;username&#x27;</span>)
        password = request.form.get(<span class="hljs-string">&#x27;password&#x27;</span>)
        <span class="hljs-keyword">if</span> username <span class="hljs-keyword">and</span> password:
            <span class="hljs-comment"># Hash the password when inserting a new user</span>
            insert_user(username, hashpw(password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), gensalt()))
            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;signin&#x27;</span>))
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;signup.html&#x27;</span>)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/signin&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">signin</span>():
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:
        username = request.form.get(<span class="hljs-string">&#x27;username&#x27;</span>)
        password = request.form.get(<span class="hljs-string">&#x27;password&#x27;</span>)
        user = get_user(username)
        <span class="hljs-comment"># Check that a user matching the username exists, and that the password matches</span>
        <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> checkpw(password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), user[<span class="hljs-string">&#x27;password&#x27;</span>]):
            session[<span class="hljs-string">&#x27;user_id&#x27;</span>] = user[<span class="hljs-string">&#x27;id&#x27;</span>]
            <span class="hljs-keyword">return</span> redirect(url_for(<span class="hljs-string">&#x27;dashboard&#x27;</span>))
    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;signin.html&#x27;</span>)8:["$","article",null,{"className":"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600","children":[["$","header",null,{"children":[["$","$L4",null,{"href":"/2020/08/02/storing-passwords-in-flask","children":["$","h2",null,{"className":"text-3xl font-bold mb-2","children":"Storing Passwords In Flask"}]}],["$","p",null,{"className":"mb-4 text-sm text-zinc-500","children":["posted by ","Carson Evans"," ·"," ","Aug 2, 2020"]}]]}],["$","section",null,{"children":["There is a plethora of guides out there about how to securely store passwords, but there are not as many of those guides that apply to Flask specifically. I spend quite a bit of my free time on the Pallets discord helping people out with their Flask questions, and often enough we have people storing passwords as plain text. So I thought I would write about the different options one has for correctly storing passwords in a Flask app.","\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"How To Store Passwords"}],"\n",["$","p",null,{"className":"my-4","children":"Quite simply put, the only way to securely store a password is to not store it at all. Instead what we do is put the password through a hashing algorithm, and store the hash output. There are so many in-depth articles about how hashing algorithms work, but in this post I'm just going to get straight to the point and show examples on how to hash/verify passwords."}],"\n",["$","p",null,{"className":"my-4","children":"There are three main options for password hashing in a Flask app. First is werkzeug's built in password hashing functions, which is the easiest since Flask is built on werkzeug so you don't have to install anything extra. Another is bcrypt which is one of the most common password hash algorithms and has implementations in just about every language. Last you could roll your own, but seriously, when it comes to cryptographic functions, please don't roll your own. There are probably other library/options out there, but in this post I am going to focus on werkzeug's built in password hashing functions, and bcrypt."}],"\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"Werkzeug Functions"}],"\n",["$","p",null,{"className":"my-4","children":["Werkzeug contains two password related functions in the ",["$","code",null,{"className":"font-bold","children":"werkzeug.security"}]," module. First is ",["$","code",null,{"className":"font-bold","children":"generate_password_hash"}]," which is used to create a password hash, and second is ",["$","code",null,{"className":"font-bold","children":"check_password_hash"}]," which is used to validate a password. It is used as follows."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-keyword\">from</span> werkzeug.security <span class=\"hljs-keyword\">import</span> generate_password_hash, check_password_hash\n\nhashed_password = generate_password_hash(<span class=\"hljs-string\">&#x27;foobar&#x27;</span>)\n\n<span class=\"hljs-built_in\">print</span>(check_password_hash(hashed_password, <span class=\"hljs-string\">&#x27;foobar&#x27;</span>)) <span class=\"hljs-comment\"># prints True</span>\n<span class=\"hljs-built_in\">print</span>(check_password_hash(hashed_password, <span class=\"hljs-string\">&#x27;foobarbaz&#x27;</span>)) <span class=\"hljs-comment\"># prints False</span>"}}]}],"\n",["$","p",null,{"className":"my-4","children":[["$","a",null,{"href":"https://werkzeug.palletsprojects.com/en/1.0.x/utils/#module-werkzeug.security","className":"font-bold underline","children":"The werkzeug docs"}]," go in to more detail about extra parameters you can pass in to customize how the password is hashed, and I encourage readers look further in to that. Here is an example of how one might use these functions in signup and signin view functions of a Flask app."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$9"}}]}],"\n",["$","p",null,{"className":"my-4","children":["The ",["$","code",null,{"className":"font-bold","children":"insert_user"}]," and ",["$","code",null,{"className":"font-bold","children":"get_user"}]," are just made up functions. In your app you would have to replace them with how you insert and find user records."]}],"\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"Bcrypt"}],"\n",["$","p",null,{"className":"my-4","children":"In order to use bcrypt, you'll first need to install its package."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"pip install bcrypt\n<span class=\"hljs-comment\"># or</span>\npipenv install bcrypt"}}]}],"\n",["$","p",null,{"className":"my-4","children":["Once it is installed, it is very similar to the werkzeug functions to use. You use the ",["$","code",null,{"className":"font-bold","children":"hashpw"}],", ",["$","code",null,{"className":"font-bold","children":"checkpw"}]," functions, and there is also a ",["$","code",null,{"className":"font-bold","children":"gensalt"}]," function."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-keyword\">from</span> bcrypt <span class=\"hljs-keyword\">import</span> hashpw, checkpw, gensalt\n\nhashed_password = hashpw(<span class=\"hljs-string\">&#x27;foobar&#x27;</span>.encode(<span class=\"hljs-string\">&#x27;utf-8&#x27;</span>), gensalt())\n\n<span class=\"hljs-built_in\">print</span>(checkpw(<span class=\"hljs-string\">&#x27;foobar&#x27;</span>.encode(<span class=\"hljs-string\">&#x27;utf-8&#x27;</span>), hashed_password)) <span class=\"hljs-comment\"># prints True</span>\n<span class=\"hljs-built_in\">print</span>(checkpw(<span class=\"hljs-string\">&#x27;foobarbaz&#x27;</span>.encode(<span class=\"hljs-string\">&#x27;utf-8&#x27;</span>), hashed_password)) <span class=\"hljs-comment\"># prints False</span>"}}]}],"\n",["$","p",null,{"className":"my-4","children":["There are three usage differences you will need to pay attention with bcrypt. First, you must pass in a salt, whereas werkzeug does that automatically. Luckily bcrypt has the ",["$","code",null,{"className":"font-bold","children":"gensalt"}]," function to make that easy. Second, the order of parameters for checking if a password is valid is opposite to the werkzeug functions. Last, you must encode passwords being passed in for hashing or checking. Just like with the werkzeug functions, you can read more about the optional parameters the bcrypt functions accept ",["$","a",null,{"href":"https://github.com/pyca/bcrypt/#usage","className":"font-bold underline","children":"in their examples"}],". Here are the same Flask view function examples, but using the bcrypt functions."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$a"}}]}],"\n",["$","p",null,{"className":"my-4","children":["As mentioned in the werkzeug example, the ",["$","code",null,{"className":"font-bold","children":"insert_user"}]," and ",["$","code",null,{"className":"font-bold","children":"get_user"}]," are just made up functions. In your app you would have to replace them with how you insert and find user records."]}],"\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"Which One Should You Use?"}],"\n",["$","p",null,{"className":"my-4","children":"If you are building a brand new app, with a brand new database, I would say just use the werkzeug functions. Why introduce a dependency if you don't need to? But if you are rewriting an app or something, and have an existing database that already has bcrypt hashed passwords, then you'll want to go with bcrypt, unless you are prepared to force every single user to reset their password. This is the nice thing about bcrypt having implementations in just about every single language. You can rewrite your app in a different language, and keep using existing hashed passwords."}],"\n",["$","p",null,{"className":"my-4","children":["I have full working Flask examples using ",["$","a",null,{"href":"https://github.com/carc1n0gen/tutorial-apps/tree/master/flask-password-hashing-werkzeug","className":"font-bold underline","children":"werkzeug password functions"}]," and ",["$","a",null,{"href":"https://github.com/carc1n0gen/tutorial-apps/tree/master/flask-password-hashing-bcrypt","className":"font-bold underline","children":"bcrypt"}]," for password hashing if you wish to reference those."]}]]}],["$","footer",null,{"className":"mt-6","children":["$","$Lb",null,{"title":"Storing Passwords In Flask","postUrl":"/2020/08/02/storing-passwords-in-flask"}]}]]}]
