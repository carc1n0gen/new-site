1:HL["/_next/static/css/0050a676ad2909c7.css",{"as":"style"}]
0:["v-9wLcP2lg67LmOmtWiE2",[[["",{"children":[["year","2019","d"],{"children":[["month","08","d"],{"children":[["day","20","d"],{"children":[["slug","validating-ajax-requests-with-wtforms-in-flask","d"],{"children":["__PAGE__?{\"year\":\"2019\",\"month\":\"08\",\"day\":\"20\",\"slug\":\"validating-ajax-requests-with-wtforms-in-flask\"}",{}]}]}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/0050a676ad2909c7.css","precedence":"next"}]],["$L3",null]]]]]
4:I{"id":7095,"chunks":["95:static/chunks/95-50505accd77bb7f4.js","224:static/chunks/224-dafab8115ea515fd.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-fd3e7a5daa90e646.js"],"name":"","async":false}
5:I{"id":7289,"chunks":["95:static/chunks/95-50505accd77bb7f4.js","185:static/chunks/app/layout-709526c1a8d7fa9c.js"],"name":"","async":false}
6:I{"id":9180,"chunks":["272:static/chunks/webpack-c4bafb552637409f.js","253:static/chunks/bce60fc1-ac9ca0033a301708.js","698:static/chunks/698-d6fab8c76027dc07.js"],"name":"default","async":false}
7:I{"id":2306,"chunks":["272:static/chunks/webpack-c4bafb552637409f.js","253:static/chunks/bce60fc1-ac9ca0033a301708.js","698:static/chunks/698-d6fab8c76027dc07.js"],"name":"default","async":false}
2:[["$","html",null,{"lang":"en","className":"dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800","children":["$","body",null,{"className":"text-zinc-700 dark:text-zinc-300","children":[["$","header",null,{"className":"bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600","children":[["$","div",null,{"className":"md:max-w-screen-md px-2 md:px-0 mx-auto","children":[["$","img",null,{"src":"/img/avatar-new.jpg","alt":"Avatar photo","className":"rounded-full mx-auto md:float-right md:-mt-4","width":"100","height":"100"}],["$","div",null,{"className":"mt-5","children":[["$","$L4",null,{"href":"/","className":"mt-2","children":["$","h1",null,{"className":"text-5xl font-bold","children":"Carson's Blog"}]}],["$","p",null,{"className":"mt-2","children":"Somewhat coherent tutorials about web stuff and things."}]]}]]}],["$","$L5",null,{}]]}],["$","main",null,{"className":"px-4 py-2 md:p-0 md:max-w-screen-md mx-auto","children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":["$","section",null,{"className":"mt-6 p-6 bg-white border border-zinc-300","children":[["$","h1",null,{"className":"font-bold text-3xl mb-4","children":"Not Found"}],["$","p",null,{"children":"Are you lost? There doesn't seem to be anything here"}]]}],"notFoundStyles":[],"childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children",["day","20","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children",["day","20","d"],"children",["slug","validating-ajax-requests-with-wtforms-in-flask","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8",null],"segment":"__PAGE__?{\"year\":\"2019\",\"month\":\"08\",\"day\":\"20\",\"slug\":\"validating-ajax-requests-with-wtforms-in-flask\"}"},"styles":[]}],"segment":["slug","validating-ajax-requests-with-wtforms-in-flask","d"]},"styles":[]}],"segment":["day","20","d"]},"styles":[]}],"segment":["month","08","d"]},"styles":[]}],"segment":["year","2019","d"]},"styles":[]}]}],["$","footer",null,{"className":"mt-6 mb-4 text-center","children":"© Carson Evans"}]]}]}],null]
3:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Validating Ajax Requests With WTForms in Flask - Carson's Blog"}],["$","meta","2",{"name":"description","content":"I've been using Flask to build web applications for over a year now. I always use WTForms for my form validation Eventually I needed to create a more interactive form that submitted with AJAX instead of a more traditional form submit, but I wanted to continue to use WTForms for validation. Here I will demonstrate how I reused my existing WTForms validation with JSON/AJAX requests."}],["$","meta","3",{"name":"keywords","content":"validation ajax flask wtforms"}],["$","meta","4",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","5",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]]
f:I{"id":4368,"chunks":["95:static/chunks/95-50505accd77bb7f4.js","224:static/chunks/224-dafab8115ea515fd.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-fd3e7a5daa90e646.js"],"name":"","async":false}
9:Td61,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
		</span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name">set</span> class = &#x27;form-control is-invalid&#x27; if form.username.errors else &#x27;form-control&#x27; %}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=class) }}</span><span class="language-xml">
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">if</span></span> form.username.errors %}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span>
            </span><span class="hljs-template-variable">{{ form.username.errors[0] }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endif</span></span> %}</span><span class="language-xml">
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name">set</span> class = &#x27;form-control is-invalid&#x27; if form.age.errors else &#x27;form-control&#x27; %}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=class) }}</span><span class="language-xml">
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">if</span></span> form.age.errors %}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span>
            </span><span class="hljs-template-variable">{{ form.age.errors[0] }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endif</span></span> %}</span><span class="language-xml">
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>a:Tab8,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;form&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
    </span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-danger my-2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;csrf_token-error&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>b:T855,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  <span class="hljs-keyword">const</span> form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;form&quot;</span>);
  <span class="hljs-keyword">const</span> successMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;success-message&quot;</span>);
  <span class="hljs-keyword">const</span> fields = {
    <span class="hljs-attr">csrf_token</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token-error&quot;</span>),
    },
    <span class="hljs-attr">username</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username-error&quot;</span>),
    },
    <span class="hljs-attr">age</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age-error&quot;</span>),
    },
  };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>c:Tc21,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  ...

  form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-keyword">async</span> (e) =&gt; {
      e.<span class="hljs-title function_">preventDefault</span>();
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/withajax&#x27;</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,
          <span class="hljs-attr">headers</span>: {
              <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>
          },
          <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
              <span class="hljs-attr">csrf_token</span>: fields.<span class="hljs-property">csrf_token</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
              <span class="hljs-attr">username</span>: fields.<span class="hljs-property">username</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
              <span class="hljs-attr">age</span>: fields.<span class="hljs-property">age</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>
          })
      });
      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
          successMessage.<span class="hljs-property">innerHTML</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
          form.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;
          successMessage.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;block&#x27;</span>;
      } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
          <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
             fields[key].<span class="hljs-property">input</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;is-invalid&#x27;</span>);
             fields[key].<span class="hljs-property">error</span>.<span class="hljs-property">innerHTML</span> = errors[key][<span class="hljs-number">0</span>];
          });
      }
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>d:Tc0a,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;form&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
    </span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-danger my-2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;csrf_token-error&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;success-message&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: none;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>e:T1357,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  <span class="hljs-keyword">const</span> form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;form&quot;</span>);
  <span class="hljs-keyword">const</span> successMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;success-message&quot;</span>);
  <span class="hljs-keyword">const</span> fields = {
    <span class="hljs-attr">csrf_token</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token-error&quot;</span>),
    },
    <span class="hljs-attr">username</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username-error&quot;</span>),
    },
    <span class="hljs-attr">age</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age-error&quot;</span>),
    },
  };
  form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;submit&quot;</span>, <span class="hljs-keyword">async</span> (e) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/withajax&quot;</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">csrf_token</span>: fields.<span class="hljs-property">csrf_token</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
        <span class="hljs-attr">username</span>: fields.<span class="hljs-property">username</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
        <span class="hljs-attr">age</span>: fields.<span class="hljs-property">age</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
      }),
    });
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
      successMessage.<span class="hljs-property">innerHTML</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
      form.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>;
      successMessage.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;block&quot;</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
        fields[key].<span class="hljs-property">input</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;is-invalid&quot;</span>);
        fields[key].<span class="hljs-property">error</span>.<span class="hljs-property">innerHTML</span> = errors[key][<span class="hljs-number">0</span>];
      });
    }
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>8:["$","article",null,{"className":"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600","children":[["$","header",null,{"children":[["$","$L4",null,{"href":"/2019/08/20/validating-ajax-requests-with-wtforms-in-flask","children":["$","h2",null,{"className":"text-3xl font-bold mb-2","children":"Validating Ajax Requests With WTForms in Flask"}]}],["$","p",null,{"className":"mb-4 text-sm text-zinc-500","children":["posted by ","Carson Evans"," ·"," ","Aug 20, 2019"]}]]}],["$","section",null,{"children":["I've been using Flask to build web applications for over a year now. I always use WTForms for my form validation Eventually I needed to create a more interactive form that submitted with AJAX instead of a more traditional form submit, but I wanted to continue to use WTForms for validation. Here I will demonstrate how I reused my existing WTForms validation with JSON/AJAX requests.","\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"The Traditional Way"}],"\n",["$","p",null,{"className":"my-4","children":["First let's start with the ",["$","em",null,{"children":"traditional"}]," way of doing things, where a form\nsubmit will cause a page reload."]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Form"}],"\n",["$","p",null,{"className":"my-4","children":"We're going to define a username which must be at least 3 but no longer than\n15 characters long, and an age which must be at least 14."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Form</span>(<span class=\"hljs-title class_ inherited__\">FlaskForm</span>):\n    username = StringField(<span class=\"hljs-string\">&#x27;Username&#x27;</span>, [\n        Length(<span class=\"hljs-built_in\">min</span>=<span class=\"hljs-number\">3</span>, <span class=\"hljs-built_in\">max</span>=<span class=\"hljs-number\">15</span>, message=<span class=\"hljs-string\">&#x27;Username must be at least %(min)s but no more than %(max)s characters&#x27;</span>)\n    ])\n    age = IntegerField(<span class=\"hljs-string\">&#x27;Age&#x27;</span>, [\n        NumberRange(<span class=\"hljs-built_in\">min</span>=<span class=\"hljs-number\">14</span>, message=<span class=\"hljs-string\">&#x27;You must be %(min)s or older to sign up&#x27;</span>)\n    ])"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Endpoint"}],"\n",["$","p",null,{"className":"my-4","children":["This is the pattern I like to use with wtforms and traditional submits. The\n",["$","code",null,{"className":"font-bold","children":"form.validate_on_submit"}]," function will evaluate true if the request method\nwas ",["$","code",null,{"className":"font-bold","children":"POST"}]," and validation passed. If the request method was ",["$","code",null,{"className":"font-bold","children":"POST"}]," but did not\npass validation, the page will re-render, and the form instance will contain\nerror messages."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/traditional&#x27;</span>, methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>, <span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">traditional</span>():\n    form = Form()\n    <span class=\"hljs-keyword\">if</span> form.validate_on_submit():\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&#x27;WOOT WOOT!&#x27;</span>\n    <span class=\"hljs-keyword\">return</span> render_template(<span class=\"hljs-string\">&#x27;traditional.html&#x27;</span>, form=form)"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Template"}],"\n",["$","p",null,{"className":"my-4","children":["Now let's render the form fields, with their labels. We're using bootstrap\nstyles for demonstration purposes. We add the ",["$","code",null,{"className":"font-bold","children":"is-invalid"}]," class to the inputs\nif there is an error message for the input, which automatically renders the\ninputs in an error state for us."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$9"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that form empty, or with data that doesn't meet the validation we defined\nand the page will \"reload\". The inputs will be in an error state, with their\nfirst error message shown."}],"\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"Now With AJAX"}],"\n",["$","p",null,{"className":"my-4","children":"There's nothing we need to change with the form. We can use it completely\nunchanged. We will of course need to change the endpoint to respond with a JSON\nstructure containing the error messages for each input, or a success message.\nWe will no longer be returning the template in the case of validation errors."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Endpoint"}],"\n",["$","p",null,{"className":"my-4","children":["The new endpoint will work a little different. Instead of using the\n",["$","code",null,{"className":"font-bold","children":"validate_on_submit"}]," function, we're going to check if ",["$","code",null,{"className":"font-bold","children":"request.method"}]," was\nPOST and call the ",["$","code",null,{"className":"font-bold","children":"validate"}]," function. If that returns ",["$","code",null,{"className":"font-bold","children":"True"}]," then respond\nwith a success message. Otherwise we use ",["$","code",null,{"className":"font-bold","children":"jsonify"}]," (imported from flask) to\nserialize the form errors in to a JSON response."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/withajax&#x27;</span>, methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>, <span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">withajax</span>():\n    form = Form()\n    <span class=\"hljs-keyword\">if</span> request.method == <span class=\"hljs-string\">&#x27;POST&#x27;</span>:\n        <span class=\"hljs-keyword\">if</span> form.validate():\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&#x27;WOOT WOOT!&#x27;</span>\n        <span class=\"hljs-keyword\">return</span> jsonify(form.errors), <span class=\"hljs-number\">400</span>\n    <span class=\"hljs-keyword\">return</span> render_template(<span class=\"hljs-string\">&#x27;withajax.html&#x27;</span>, form=form)"}}]}],"\n",["$","p",null,{"className":"my-4","children":"We no longer need the jinja conditions to show the inputs in an invalid state,\nas we will be doing that logic in JavaScript now."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Template"}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$a"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that form empty, and the browser will load a new page containing\na JSON structure. Now obviously we can't leave it that way, so let's add some\nJavaScript that overrides what happens on form submit."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Template With JavaScript"}],"\n",["$","p",null,{"className":"my-4","children":["First let's get use ",["$","code",null,{"className":"font-bold","children":"getElementById"}]," to get references to all the elements we\nwill need."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$b"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Now we could have simply stored references in to individual variables instead\nof an object structure, but doing it like this will be make things easier."}],"\n",["$","p",null,{"className":"my-4","children":"Next let's override the form submit behaviour."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$c"}}]}],"\n",["$","p",null,{"className":"my-4","children":["So you'll see in the ",["$","code",null,{"className":"font-bold","children":"else"}]," of the ",["$","code",null,{"className":"font-bold","children":"if (response.ok)"}]," check we actually\niterate over the keys of the response object. This is what I meant earlier\nwhen I said storing references to our inputs in an object structure would make\nout lives easier. We can simply iterate the keys in the validation errors,\nand use those keys to refer to the input that needs to be updated to be in an\nerror state."]}],"\n",["$","p",null,{"className":"my-4","children":"One last thing we need before this will work is to create the div used to\ndisplay the success message when validation passes."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;success-message&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;display: none;&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"Here's the final template"}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$d"}}]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[25px]","children":["$","code",null,{"className":"hljs","dangerouslySetInnerHTML":{"__html":"$e"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that with invalid data, and the fields will change to an error state\nwith error messages. Submit valid data, and you'll get a success message."}],"\n",["$","p",null,{"className":"my-4","children":["If you would like to reference a complete working flask app demonstrating all\nthis, I have one right ",["$","a",null,{"href":"https://github.com/carc1n0gen/tutorial-apps/tree/master/flask-wtforms-ajax","className":"font-bold underline","children":"here on github"}],"."]}]]}],["$","footer",null,{"className":"mt-6","children":["$","$Lf",null,{"title":"Validating Ajax Requests With WTForms in Flask","postUrl":"/2019/08/20/validating-ajax-requests-with-wtforms-in-flask"}]}]]}]
