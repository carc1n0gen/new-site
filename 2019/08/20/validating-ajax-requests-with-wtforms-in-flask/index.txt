1:HL["/_next/static/css/b6c25231bd1a8eb6.css",{"as":"style"}]
0:["Le8_eEVhl8d-YmcPazncP",[[["",{"children":[["year","2019","d"],{"children":[["month","08","d"],{"children":[["day","20","d"],{"children":[["slug","validating-ajax-requests-with-wtforms-in-flask","d"],{"children":["__PAGE__?{\"year\":\"2019\",\"month\":\"08\",\"day\":\"20\",\"slug\":\"validating-ajax-requests-with-wtforms-in-flask\"}",{}]}]}]}]}]},"$undefined","$undefined",true],"$L2",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/b6c25231bd1a8eb6.css","precedence":"next"}]],["$L3",null]]]]]
4:I{"id":7095,"chunks":["95:static/chunks/95-564ee2c3cce6bef5.js","224:static/chunks/224-a739c60a74fa69d1.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-87024f47ad3ba280.js"],"name":"","async":false}
5:I{"id":2855,"chunks":["95:static/chunks/95-564ee2c3cce6bef5.js","185:static/chunks/app/layout-81558bd6022afcd4.js"],"name":"","async":false}
6:I{"id":9180,"chunks":["272:static/chunks/webpack-d4a52de16ad71d6d.js","253:static/chunks/bce60fc1-ebeb496586ce224e.js","698:static/chunks/698-566acd7bad4a6521.js"],"name":"default","async":false}
7:I{"id":2306,"chunks":["272:static/chunks/webpack-d4a52de16ad71d6d.js","253:static/chunks/bce60fc1-ebeb496586ce224e.js","698:static/chunks/698-566acd7bad4a6521.js"],"name":"default","async":false}
a:I{"id":7409,"chunks":["95:static/chunks/95-564ee2c3cce6bef5.js","185:static/chunks/app/layout-81558bd6022afcd4.js"],"name":"","async":false}
9:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z2:[["$","html",null,{"lang":"en","className":"dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800","children":[["$","link",null,{"rel":"alternate","type":"application/atom+xml","title":"Atom Feed for Carson's Blog","href":"/feed.xml"}],["$","body",null,{"className":"text-zinc-700 dark:text-zinc-100","children":[["$","header",null,{"className":"bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600","children":[["$","div",null,{"className":"md:max-w-screen-md px-2 md:px-0 mx-auto","children":[["$","img",null,{"src":"/img/avatar-new.jpg","alt":"Avatar photo","className":"rounded-full mx-auto md:float-right md:-mt-4","width":"100","height":"100"}],["$","div",null,{"className":"mt-5","children":[["$","$L4",null,{"href":"/","className":"mt-2","children":["$","h1",null,{"className":"text-5xl font-bold","children":"Carson's Blog"}]}],["$","p",null,{"className":"mt-2","children":"Somewhat coherent tutorials about web stuff and things."}]]}]]}],["$","$L5",null,{}]]}],["$","main",null,{"className":"px-4 py-2 md:p-0 md:max-w-screen-md mx-auto","children":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":["$","div",null,{"className":"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 ","children":[["$","h1",null,{"className":"font-bold text-3xl mb-4","children":"Not Found"}],["$","p",null,{"children":"Are you lost? There doesn't seem to be anything here"}]]}],"notFoundStyles":[],"childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children",["day","20","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L6",null,{"parallelRouterKey":"children","segmentPath":["children",["year","2019","d"],"children",["month","08","d"],"children",["day","20","d"],"children",["slug","validating-ajax-requests-with-wtforms-in-flask","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L7",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L8",null],"segment":"__PAGE__?{\"year\":\"2019\",\"month\":\"08\",\"day\":\"20\",\"slug\":\"validating-ajax-requests-with-wtforms-in-flask\"}"},"styles":[]}],"segment":["slug","validating-ajax-requests-with-wtforms-in-flask","d"]},"styles":[]}],"segment":["day","20","d"]},"styles":[]}],"segment":["month","08","d"]},"styles":[]}],"segment":["year","2019","d"]},"styles":[]}]}],["$","footer",null,{"className":"mt-6 mb-6 flex items-center justify-center","children":["© Carson Evans"," ",["$","$L4",null,{"title":"Github","href":"https://github.com/carc1n0gen","target":"_blank","className":"ml-5","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 496 512","className":"inline","children":["$undefined",[["$","path","0",{"d":"$9","children":"$undefined"}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]}],["$","$L4",null,{"title":"Instagram","href":"https://www.instagram.com/carsonphotosandstuff/","target":"_blank","className":"ml-5","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 448 512","className":"inline","children":["$undefined",[["$","path","0",{"d":"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z","children":"$undefined"}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]}],["$","a",null,{"title":"Atom Feed","href":"/feed.xml","target":"_blank","className":"ml-5","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 448 512","className":"inline","children":["$undefined",[["$","path","0",{"d":"M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z","children":"$undefined"}]]],"style":{"color":"$undefined"},"height":"1em","width":"1em","xmlns":"http://www.w3.org/2000/svg"}]}]]}],["$","$La",null,{}]]}]]}],null]
3:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Validating Ajax Requests With WTForms in Flask - Carson's Blog"}],["$","meta","2",{"name":"description","content":"I've been using Flask to build web applications for over a year now. I always use WTForms for my form validation Eventually I needed to create a more interactive form that submitted with AJAX instead of a more traditional form submit, but I wanted to continue to use WTForms for validation. Here I will demonstrate how I reused my existing WTForms validation with JSON/AJAX requests."}],["$","meta","3",{"name":"keywords","content":"validation ajax flask wtforms"}],["$","meta","4",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","5",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]]
11:I{"id":3376,"chunks":["95:static/chunks/95-564ee2c3cce6bef5.js","224:static/chunks/224-a739c60a74fa69d1.js","106:static/chunks/app/[year]/[month]/[day]/[slug]/page-87024f47ad3ba280.js"],"name":"","async":false}
b:Td61,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
		</span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name">set</span> class = &#x27;form-control is-invalid&#x27; if form.username.errors else &#x27;form-control&#x27; %}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=class) }}</span><span class="language-xml">
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">if</span></span> form.username.errors %}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span>
            </span><span class="hljs-template-variable">{{ form.username.errors[0] }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endif</span></span> %}</span><span class="language-xml">
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name">set</span> class = &#x27;form-control is-invalid&#x27; if form.age.errors else &#x27;form-control&#x27; %}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=class) }}</span><span class="language-xml">
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">if</span></span> form.age.errors %}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span>
            </span><span class="hljs-template-variable">{{ form.age.errors[0] }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        </span><span class="hljs-template-tag">{% <span class="hljs-name"><span class="hljs-name">endif</span></span> %}</span><span class="language-xml">
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>c:Tab8,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;form&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
    </span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-danger my-2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;csrf_token-error&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>d:T855,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  <span class="hljs-keyword">const</span> form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;form&quot;</span>);
  <span class="hljs-keyword">const</span> successMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;success-message&quot;</span>);
  <span class="hljs-keyword">const</span> fields = {
    <span class="hljs-attr">csrf_token</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token-error&quot;</span>),
    },
    <span class="hljs-attr">username</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username-error&quot;</span>),
    },
    <span class="hljs-attr">age</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age-error&quot;</span>),
    },
  };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>e:Tc21,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  ...

  form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;submit&#x27;</span>, <span class="hljs-keyword">async</span> (e) =&gt; {
      e.<span class="hljs-title function_">preventDefault</span>();
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/withajax&#x27;</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,
          <span class="hljs-attr">headers</span>: {
              <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>
          },
          <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
              <span class="hljs-attr">csrf_token</span>: fields.<span class="hljs-property">csrf_token</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
              <span class="hljs-attr">username</span>: fields.<span class="hljs-property">username</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
              <span class="hljs-attr">age</span>: fields.<span class="hljs-property">age</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>
          })
      });
      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
          successMessage.<span class="hljs-property">innerHTML</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
          form.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;
          successMessage.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;block&#x27;</span>;
      } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
          <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
             fields[key].<span class="hljs-property">input</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;is-invalid&#x27;</span>);
             fields[key].<span class="hljs-property">error</span>.<span class="hljs-property">innerHTML</span> = errors[key][<span class="hljs-number">0</span>];
          });
      }
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>f:Tc0a,<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;form&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
    </span><span class="hljs-template-variable">{{ form.csrf_token }}</span><span class="language-xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text-danger my-2&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;csrf_token-error&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.username.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.username(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;username-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-group&quot;</span>&gt;</span>
        </span><span class="hljs-template-variable">{{ form.age.label }}</span><span class="language-xml">
        </span><span class="hljs-template-variable">{{ form.age(class=&#x27;form-control&#x27;) }}</span><span class="language-xml">
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;age-error&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;invalid-feedback&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;</span>Signup<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;success-message&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display: none;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>10:T1357,<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript">
  <span class="hljs-keyword">const</span> form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;form&quot;</span>);
  <span class="hljs-keyword">const</span> successMessage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;success-message&quot;</span>);
  <span class="hljs-keyword">const</span> fields = {
    <span class="hljs-attr">csrf_token</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;csrf_token-error&quot;</span>),
    },
    <span class="hljs-attr">username</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;username-error&quot;</span>),
    },
    <span class="hljs-attr">age</span>: {
      <span class="hljs-attr">input</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age&quot;</span>),
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;age-error&quot;</span>),
    },
  };
  form.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;submit&quot;</span>, <span class="hljs-keyword">async</span> (e) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&quot;/withajax&quot;</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;POST&quot;</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">csrf_token</span>: fields.<span class="hljs-property">csrf_token</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
        <span class="hljs-attr">username</span>: fields.<span class="hljs-property">username</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
        <span class="hljs-attr">age</span>: fields.<span class="hljs-property">age</span>.<span class="hljs-property">input</span>.<span class="hljs-property">value</span>,
      }),
    });
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
      successMessage.<span class="hljs-property">innerHTML</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
      form.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>;
      successMessage.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;block&quot;</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
        fields[key].<span class="hljs-property">input</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&quot;is-invalid&quot;</span>);
        fields[key].<span class="hljs-property">error</span>.<span class="hljs-property">innerHTML</span> = errors[key][<span class="hljs-number">0</span>];
      });
    }
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>8:["$","article",null,{"className":"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 ","children":[["$","header",null,{"children":[["$","$L4",null,{"href":"/2019/08/20/validating-ajax-requests-with-wtforms-in-flask","children":["$","h2",null,{"className":"text-3xl font-bold mb-2","children":"Validating Ajax Requests With WTForms in Flask"}]}],["$","p",null,{"className":"mb-4 text-sm text-zinc-400","children":["posted by ","Carson Evans"," ·"," ","Aug 20, 2019"]}]]}],["$","section",null,{"children":["I've been using Flask to build web applications for over a year now. I always use WTForms for my form validation Eventually I needed to create a more interactive form that submitted with AJAX instead of a more traditional form submit, but I wanted to continue to use WTForms for validation. Here I will demonstrate how I reused my existing WTForms validation with JSON/AJAX requests.","\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"The Traditional Way"}],"\n",["$","p",null,{"className":"my-4","children":["First let's start with the ",["$","em",null,{"children":"traditional"}]," way of doing things, where a form\nsubmit will cause a page reload."]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Form"}],"\n",["$","p",null,{"className":"my-4","children":"We're going to define a username which must be at least 3 but no longer than\n15 characters long, and an age which must be at least 14."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Form</span>(<span class=\"hljs-title class_ inherited__\">FlaskForm</span>):\n    username = StringField(<span class=\"hljs-string\">&#x27;Username&#x27;</span>, [\n        Length(<span class=\"hljs-built_in\">min</span>=<span class=\"hljs-number\">3</span>, <span class=\"hljs-built_in\">max</span>=<span class=\"hljs-number\">15</span>, message=<span class=\"hljs-string\">&#x27;Username must be at least %(min)s but no more than %(max)s characters&#x27;</span>)\n    ])\n    age = IntegerField(<span class=\"hljs-string\">&#x27;Age&#x27;</span>, [\n        NumberRange(<span class=\"hljs-built_in\">min</span>=<span class=\"hljs-number\">14</span>, message=<span class=\"hljs-string\">&#x27;You must be %(min)s or older to sign up&#x27;</span>)\n    ])"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Endpoint"}],"\n",["$","p",null,{"className":"my-4","children":["This is the pattern I like to use with wtforms and traditional submits. The\n",["$","code",null,{"className":"font-bold","children":"form.validate_on_submit"}]," function will evaluate true if the request method\nwas ",["$","code",null,{"className":"font-bold","children":"POST"}]," and validation passed. If the request method was ",["$","code",null,{"className":"font-bold","children":"POST"}]," but did not\npass validation, the page will re-render, and the form instance will contain\nerror messages."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/traditional&#x27;</span>, methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>, <span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">traditional</span>():\n    form = Form()\n    <span class=\"hljs-keyword\">if</span> form.validate_on_submit():\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&#x27;WOOT WOOT!&#x27;</span>\n    <span class=\"hljs-keyword\">return</span> render_template(<span class=\"hljs-string\">&#x27;traditional.html&#x27;</span>, form=form)"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The Template"}],"\n",["$","p",null,{"className":"my-4","children":["Now let's render the form fields, with their labels. We're using bootstrap\nstyles for demonstration purposes. We add the ",["$","code",null,{"className":"font-bold","children":"is-invalid"}]," class to the inputs\nif there is an error message for the input, which automatically renders the\ninputs in an error state for us."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$b"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that form empty, or with data that doesn't meet the validation we defined\nand the page will \"reload\". The inputs will be in an error state, with their\nfirst error message shown."}],"\n",["$","h2",null,{"className":"text-2xl font-bold mt-6 mb-2","children":"Now With AJAX"}],"\n",["$","p",null,{"className":"my-4","children":"There's nothing we need to change with the form. We can use it completely\nunchanged. We will of course need to change the endpoint to respond with a JSON\nstructure containing the error messages for each input, or a success message.\nWe will no longer be returning the template in the case of validation errors."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Endpoint"}],"\n",["$","p",null,{"className":"my-4","children":["The new endpoint will work a little different. Instead of using the\n",["$","code",null,{"className":"font-bold","children":"validate_on_submit"}]," function, we're going to check if ",["$","code",null,{"className":"font-bold","children":"request.method"}]," was\nPOST and call the ",["$","code",null,{"className":"font-bold","children":"validate"}]," function. If that returns ",["$","code",null,{"className":"font-bold","children":"True"}]," then respond\nwith a success message. Otherwise we use ",["$","code",null,{"className":"font-bold","children":"jsonify"}]," (imported from flask) to\nserialize the form errors in to a JSON response."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-meta\">@app.route(<span class=\"hljs-params\"><span class=\"hljs-string\">&#x27;/withajax&#x27;</span>, methods=[<span class=\"hljs-string\">&#x27;GET&#x27;</span>, <span class=\"hljs-string\">&#x27;POST&#x27;</span>]</span>)</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">withajax</span>():\n    form = Form()\n    <span class=\"hljs-keyword\">if</span> request.method == <span class=\"hljs-string\">&#x27;POST&#x27;</span>:\n        <span class=\"hljs-keyword\">if</span> form.validate():\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&#x27;WOOT WOOT!&#x27;</span>\n        <span class=\"hljs-keyword\">return</span> jsonify(form.errors), <span class=\"hljs-number\">400</span>\n    <span class=\"hljs-keyword\">return</span> render_template(<span class=\"hljs-string\">&#x27;withajax.html&#x27;</span>, form=form)"}}]}],"\n",["$","p",null,{"className":"my-4","children":"We no longer need the jinja conditions to show the inputs in an invalid state,\nas we will be doing that logic in JavaScript now."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Template"}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$c"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that form empty, and the browser will load a new page containing\na JSON structure. Now obviously we can't leave it that way, so let's add some\nJavaScript that overrides what happens on form submit."}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"The New Template With JavaScript"}],"\n",["$","p",null,{"className":"my-4","children":["First let's get use ",["$","code",null,{"className":"font-bold","children":"getElementById"}]," to get references to all the elements we\nwill need."]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$d"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Now we could have simply stored references in to individual variables instead\nof an object structure, but doing it like this will be make things easier."}],"\n",["$","p",null,{"className":"my-4","children":"Next let's override the form submit behaviour."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$e"}}]}],"\n",["$","p",null,{"className":"my-4","children":["So you'll see in the ",["$","code",null,{"className":"font-bold","children":"else"}]," of the ",["$","code",null,{"className":"font-bold","children":"if (response.ok)"}]," check we actually\niterate over the keys of the response object. This is what I meant earlier\nwhen I said storing references to our inputs in an object structure would make\nout lives easier. We can simply iterate the keys in the validation errors,\nand use those keys to refer to the input that needs to be updated to be in an\nerror state."]}],"\n",["$","p",null,{"className":"my-4","children":"One last thing we need before this will work is to create the div used to\ndisplay the success message when validation passes."}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;success-message&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;display: none;&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>"}}]}],"\n",["$","h3",null,{"className":"text-xl font-bold mt-6 mb-2","children":"Here's the final template"}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$f"}}]}],"\n",["$","pre",null,{"className":"my-4 -mx-4 md:-mx-[24px]","children":["$","code",null,{"className":"hljs bg-zinc-100 dark:bg-zinc-700","dangerouslySetInnerHTML":{"__html":"$10"}}]}],"\n",["$","p",null,{"className":"my-4","children":"Submit that with invalid data, and the fields will change to an error state\nwith error messages. Submit valid data, and you'll get a success message."}],"\n",["$","p",null,{"className":"my-4","children":["If you would like to reference a complete working flask app demonstrating all\nthis, I have one right ",["$","a",null,{"href":"https://github.com/carc1n0gen/tutorial-apps/tree/master/flask-wtforms-ajax","className":"font-bold underline","children":"here on github"}],"."]}]]}],["$","footer",null,{"className":"mt-6","children":["$","$L11",null,{"title":"Validating Ajax Requests With WTForms in Flask","postUrl":"/2019/08/20/validating-ajax-requests-with-wtforms-in-flask"}]}]]}]
