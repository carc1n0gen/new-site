<!DOCTYPE html><html lang="en" class="dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800"><head><meta charSet="utf-8"/><link rel="stylesheet" href="/_next/static/css/ca7ad881d0200469.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-f8cd44685030620d.js" as="script"/><link rel="preload" href="/_next/static/chunks/bce60fc1-ebeb496586ce224e.js" as="script"/><link rel="preload" href="/_next/static/chunks/698-566acd7bad4a6521.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-app-5d759ffdb2cae9fb.js" as="script"/><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=G-0HTY1R4GPX"/><link rel="alternate" type="application/atom+xml" title="Atom Feed for Carson&#x27;s Blog" href="/feed.xml"/><title>Create an Async Chat Server and Client With Dart - Carson&#x27;s Blog</title><meta name="description" content="Before starting this tutorial you should be familiar with my previous post about creating your first webapp in dart.  In this tutorial we are going to make two Dart projects.  The first one will be a command line application for the server, the second one will be a web application for the client.  We will be using WebSockets for communication between server and client."/><meta name="keywords" content="chat async dart"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="text-zinc-700 dark:text-zinc-100"><header class="bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600"><div class="md:max-w-screen-md px-2 md:px-0 mx-auto"><img src="/img/avatar-new.jpg" alt="Avatar photo" class="rounded-full mx-auto md:float-right md:-mt-4" width="100" height="100"/><div class="mt-5"><a class="mt-2" href="/"><h1 class="text-5xl font-bold">Carson&#x27;s Blog</h1></a><p class="mt-2">Somewhat coherent tutorials about web stuff and things.</p></div></div><nav class="border-t border-t-zinc-300 dark:border-t-zinc-600 mt-5 md:mt-10 py-5"><div class="md:max-w-screen-md mx-auto"><a class="mx-3 hover:text-zinc-400 dark:hover:text-zinc-200 font-bold border-b-4 border-b-zinc-300 dark:border-b-zinc-600" href="/">Blog</a><a class="mx-3 hover:text-zinc-400 dark:hover:text-zinc-200  " href="/archive/">Archive</a><a class="mx-3 hover:text-zinc-400 dark:hover:text-zinc-200  " href="/contact/">Contact</a><!--$!--><template data-dgst="NEXT_DYNAMIC_NO_SSR_CODE"></template><form class="mt-5 md:-mt-1 md:float-right" action="/search"><input type="text" placeholder="Search for posts" aria-label="Search for posts" class="border dark:border-zinc-500 border-r-0 rounded-md rounded-r-none p-1 bg-zinc-50 dark:bg-zinc-700" name="q"/><button type="submit" class="px-4 py-1 border border-l-0 border-blue-600 dark:border-blue-500 rounded-md rounded-l-none bg-blue-600 text-blue-50">Search</button></form><!--/$--></div></nav></header><main class="px-4 py-2 md:p-0 md:max-w-screen-md mx-auto"><article class="mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 "><header><a href="/2014/07/25/create-an-async-chat-server-and-client-with-dart/"><h2 class="text-3xl font-bold mb-2">Create an Async Chat Server and Client With Dart</h2></a><p class="mb-4 text-sm text-zinc-400">posted by <!-- -->Carson Evans<!-- --> Â·<!-- --> <!-- -->Jul 25, 2014</p></header><section>Before starting this tutorial you should be familiar with my previous post about creating your first webapp in dart.  In this tutorial we are going to make two Dart projects.  The first one will be a command line application for the server, the second one will be a web application for the client.  We will be using WebSockets for communication between server and client.<!-- -->
<h2 class="text-2xl font-bold mt-6 mb-2">Creating the server</h2>
<p class="my-4">Open up the Dart IDE and start a new project. Name it ChatServer and pick the <code class="font-bold">Command-line application</code> template. A command line application means this project has no GUI, it just runs in the command prompt or terminal. The default command line application has a bin folder with one main script that acts as the entry point for the application. The script should look something like this:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">void</span> main() {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello, World!&quot;</span>);
}</code></pre>
<p class="my-4">Above the main function we need to add an import, create a constant to hold the port the server will listen too, and create a list to hold web socket connections:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:io&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> PORT = <span class="hljs-number">9090</span>;

<span class="hljs-built_in">List</span>&lt;WebSocket&gt; connections;</code></pre>
<p class="my-4">In Dart, to make a websocket server you make a http server and <em>transform</em> it into a websocket server. Delete the contents of the main function, initialize the connections list, and bind an http server using the constant we made earlier as the port number:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:io&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> PORT = <span class="hljs-number">9090</span>;

<span class="hljs-built_in">List</span>&lt;WebSocket&gt; connections;

<span class="hljs-keyword">void</span> main() {
  connections = <span class="hljs-keyword">new</span> <span class="hljs-built_in">List</span>&lt;WebSocket&gt;();

  HttpServer.bind(InternetAddress.ANY_UP_V4, PORT).then((HttpServer server) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Server listening on port <span class="hljs-subst">${PORT}</span>.&#x27;</span>);
  });
}</code></pre>
<p class="my-4">This syntax might look a little strange to people not familiar Dart or asynchronous programming. The <code class="font-bold">bind</code> method of the HttpServer class is asynchronous and will return an instance of a HttpServer some time in the future. All asynchronous methods in Dart act this way and have a <code class="font-bold">then</code> method that is called when they are done. You provide the <code class="font-bold">then</code> method with a callback that accepts the type returned by the asynchronous method. This callback is executed when the asynchronous method is complete and the <code class="font-bold">then</code> method is run. In our case, we are passing an anonymous function as a callback to the <code class="font-bold">then</code> method, and all this callback does at this point is print what port the server is listening on.</p>
<p class="my-4">Now lets make the http server listen for requests:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Server listening on port <span class="hljs-subst">${PORT}</span>.&#x27;</span>);
server.listen((HttpRequest request) {
  <span class="hljs-keyword">if</span> (WebsocketTransformer.isUpgradeRequest(request)) {
    <span class="hljs-comment">// Transform to websocket</span>
  } <span class="hljs-keyword">else</span> {
    request.response.statusCode = HttpStatus.FORBIDDEN;
    request.response.reasonPhrase = <span class="hljs-string">&#x27;Websocket connections only!&#x27;</span>;
    request.response.close();
  }
});</code></pre>
<p class="my-4">Here we are checking if the request is a websocket request and if it is not then we send the client connecion an error message. Next we will do the websocket work.</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">if</span> (WebsocketTransformer.isUpgradeRequest(request)) {
  WebSocketTransformer.upgrade(request).then((WebSocket ws) {
    connections.add(ws);
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Client connected, there are now <span class="hljs-subst">${connections.length}</span> client(s) connected.&#x27;</span>);
    ws.listen((<span class="hljs-built_in">String</span> message) {
      <span class="hljs-keyword">for</span> (WebSocket connection <span class="hljs-keyword">in</span> connections) {
        connection.add(message);
      }
    },
    onDone: () {
      connections.remove(ws);
      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Client disconnected, there are now <span class="hljs-subst">${connections.legnth}</span> client(s) connected.&#x27;</span>);
    });
  });
} <span class="hljs-keyword">else</span> {
  request.response.statusCode = HttpStatus.FORBIDDEN;
  request.response.reasonPhrase = <span class="hljs-string">&#x27;Websocket connections only!&#x27;</span>;
  request.response.close();
}</code></pre>
<p class="my-4">Here we transform the request to a websocket connection and add it to our list of connections. Then we listen for messages coming from the websocket connection and send that message to every connection in the list of connections.</p>
<p class="my-4">The complete code should look like this:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:io&#x27;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-built_in">int</span> PORT = <span class="hljs-number">9090</span>;

<span class="hljs-built_in">List</span>&lt;WebSocket&gt; connections;

<span class="hljs-keyword">void</span> main() {
  connections = <span class="hljs-keyword">new</span> <span class="hljs-built_in">List</span>&lt;WebSocket&gt;();

  HttpServer.bind(InternetAddress.ANY_IP_V4, PORT).then((HttpServer server) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Server listening on port <span class="hljs-subst">${PORT}</span>.&#x27;</span>);
    server.listen((HttpRequest request) {
      <span class="hljs-keyword">if</span> (WebSocketTransformer.isUpgradeRequest(request)) {
        WebSocketTransformer.upgrade(request).then((WebSocket ws) {
          connections.add(ws);
          <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Client connected, there are now <span class="hljs-subst">${connections.length}</span> client(s) connected.&#x27;</span>);
          ws.listen((<span class="hljs-built_in">String</span> message) {
            <span class="hljs-keyword">for</span> (WebSocket connection <span class="hljs-keyword">in</span> connections) {
              connection.add(message);
            }
          },
          onDone: () {
            connections.remove(ws);
            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Client disconnected, there are now <span class="hljs-subst">${connections.length}</span> client(s) connected.&#x27;</span>);
          });
        });
      } <span class="hljs-keyword">else</span> {
        request.response.statusCode = HttpStatus.FORBIDDEN;
        request.response.reasonPhrase = <span class="hljs-string">&#x27;Websocket connections only!&#x27;</span>;
        request.response.close();
      }
    });
  });
}</code></pre>
<p class="my-4">You can now run this project, but it doesn&#x27;t do anything because there is no client to connect with</p>
<h2 class="text-2xl font-bold mt-6 mb-2">Creating the client</h2>
<p class="my-4">Start another new project with the name ChatClient with the <code class="font-bold">Web application</code> template. In Dart web applications have a web folder where everything will go. By default there will be a html, css, and dart file. Open up the html file and delete everything inside the body tags then add the following:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ChatClient<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nickname&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;savenickname&quot;</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;output&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;input&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;send&quot;</span>&gt;</span>Send<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;application/dart&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;chatclient.dart&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;packages/browser/dart.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre>
<p class="my-4">The first input is where you will enter your nickname with a button that saves it. Then there is a <code class="font-bold">div</code> that will be used for do display chat messages, a <code class="font-bold">textarea</code> for chat input, and a send button for sending message to the server. At the end there is two script references.</p>
<p class="my-4">The first script reference is the main Dart script for the web application and is where we will be coding our logic. The second script is a special script used to detect if the web browser supports Dart or not and will fallback to the JavaScript compiled version of the web app.</p>
<p class="my-4">Open up the css file and delete everything and add the following:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-selector-id">#output</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
}</code></pre>
<p class="my-4">Open up the Dart script and delete everything below the main function and inside the main function. Above the main function add an import for DOM support:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:html&#x27;</span>;</code></pre>
<p class="my-4">Inside the main function we need to select the elements we need with <code class="font-bold">querySelector</code>:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">void</span> main() {
  InputElement nickname = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#nickname&#x27;</span>);
  DivElement output = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#output&#x27;</span>);
  TextAreaElement input = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#input&#x27;</span>);
  ButtonElement send = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#send&#x27;</span>);
  ButtonElement savenickname = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#savenickname&#x27;</span>);
}</code></pre>
<p class="my-4">Next create a WebSocket connection:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700">WebSocket ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">&#x27;ws://localhost:9090&#x27;</span>);</code></pre>
<p class="my-4">Now when the save nickname button is clicked we need to make the nickname field read only.</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700">savenickname.onClick.listen((MouseEvent event) {
  <span class="hljs-keyword">if</span> (nickname.value != <span class="hljs-string">&#x27;&#x27;</span>) {
    nickname.readOnly = <span class="hljs-keyword">true</span>;
  }
});</code></pre>
<p class="my-4">Then we make the send button actually send the contents of the input to the server. We only want to send the message if the nickname is read only (has been saved) and the input isnt empty:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700">send.onClick.listen((MouseEvent event) {
  <span class="hljs-keyword">if</span> (nickname.value != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; nickname.readOnly) {
    <span class="hljs-built_in">String</span> message = input.value;
    input.value = <span class="hljs-string">&#x27;&#x27;</span>;
    input.focus();
    ws.send(<span class="hljs-string">&quot;<span class="hljs-subst">${nickname.value}</span>: <span class="hljs-subst">${message}</span>&quot;</span>);
  }
});</code></pre>
<p class="my-4">Finally we need to listen to the connection to the server for messages to display in the output <code class="font-bold">div</code>:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700">ws.addEventListener(<span class="hljs-string">&#x27;message&#x27;</span>, (event) {
  <span class="hljs-built_in">String</span> message = event.data;
  output.innerHtml += <span class="hljs-string">&#x27;&lt;p&gt;<span class="hljs-subst">${message}</span>&lt;/p&gt;&#x27;</span>;
});</code></pre>
<p class="my-4">Here is the complete code:</p>
<pre class="my-4 -mx-4 md:-mx-[24px]"><code class="hljs bg-zinc-100 dark:bg-zinc-700"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:html&#x27;</span>;

<span class="hljs-keyword">void</span> main() {
  InputElement nickname = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#nickname&#x27;</span>);
  DivElement output = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#output&#x27;</span>);
  TextAreaElement input = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#input&#x27;</span>);
  ButtonElement send = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#send&#x27;</span>);
  ButtonElement savenickname = <span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#savenickname&#x27;</span>);
  WebSocket ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">&#x27;ws://localhost:9090&#x27;</span>);

  savenickname.onClick.listen((MouseEvent event) {
    <span class="hljs-keyword">if</span> (nickname.value != <span class="hljs-string">&#x27;&#x27;</span>) {
      nickname.readOnly = <span class="hljs-keyword">true</span>;
    }
  });

  send.onClick.listen((MouseEvent event) {
    <span class="hljs-keyword">if</span> (nickname.value != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; nickname.readOnly) {
      <span class="hljs-built_in">String</span> message = input.value;
      input.value = <span class="hljs-string">&#x27;&#x27;</span>;
      input.focus();
      ws.send(<span class="hljs-string">&quot;<span class="hljs-subst">${nickname.value}</span>: <span class="hljs-subst">${message}</span>&quot;</span>);
    }
  });

  ws.addEventListener(<span class="hljs-string">&#x27;message&#x27;</span>, (event) {
    Message msg = <span class="hljs-keyword">new</span> Message.FromJson(event.data);
    output.innerHtml += <span class="hljs-string">&#x27;&lt;p&gt;<span class="hljs-subst">${message}</span>&lt;/p&gt;&#x27;</span>;
  });
}</code></pre>
<h2 class="text-2xl font-bold mt-6 mb-2">Conclusion</h2>
<p class="my-4">Now you can run the chat server, then run the chat client. Enter a nickname, enter a message and click send. You should then see your message. You can copy the url for the chat client and open multiple tabs and go to that url. Each tab will count as a new connection to the server so they can all talk to each other.</p></section><footer class="mt-6"><p class="mb-4 text-sm text-zinc-400">Updated<!-- --> <!-- -->Sep 15, 2023</p><div id="disqus_thread"></div></footer></article></main><footer class="mt-6 mb-6 flex items-center justify-center">Â© Carson Evans<!-- --> <a title="Github" target="_blank" class="ml-5" href="https://github.com/carc1n0gen"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="inline" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a title="Instagram" target="_blank" class="ml-5" href="https://www.instagram.com/carsonphotosandstuff/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="inline" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a><a title="Atom Feed" href="/feed.xml" target="_blank" class="ml-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="inline" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg></a></footer><script src="/_next/static/chunks/webpack-f8cd44685030620d.js" async=""></script><script src="/_next/static/chunks/bce60fc1-ebeb496586ce224e.js" async=""></script><script src="/_next/static/chunks/698-566acd7bad4a6521.js" async=""></script><script src="/_next/static/chunks/main-app-5d759ffdb2cae9fb.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/ca7ad881d0200469.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I{\"id\":2353,\"chunks\":[\"272:static/chunks/webpack-f8cd44685030620d.js\",\"253:static/chunks/bce60fc1-ebeb496586ce224e.js\",\"698:static/chunks/698-566acd7bad4a6521.js\"],\"name\":\"default\",\"async\":false}\n5:I{\"id\":7330,\"chunks\":[\"272:static/chunks/webpack-f8cd44685030620d.js\",\"253:static/chunks/bce60fc1-ebeb496586ce224e.js\",\"698:static/chunks/698-566acd7bad4a6521.js\"],\"name\":\"\",\"async\":false}\n6:I{\"id\":7095,\"chunks\":[\"95:static/chunks/95-564ee2c3cce6bef5.js\",\"224:static/chunks/224-a739c60a74fa69d1.js\",\"106:static/c"])</script><script>self.__next_f.push([1,"hunks/app/[year]/[month]/[day]/[slug]/page-87024f47ad3ba280.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":2855,\"chunks\":[\"95:static/chunks/95-564ee2c3cce6bef5.js\",\"185:static/chunks/app/layout-af9224d3da924ad1.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":7409,\"chunks\":[\"95:static/chunks/95-564ee2c3cce6bef5.js\",\"185:static/chunks/app/layout-af9224d3da924ad1.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":9180,\"chunks\":[\"272:static/chunks/webpack-f8cd44685030620d.js\",\"253:static/chunks/bce60fc1-ebeb496586ce224e.js\",\"698:static/chu"])</script><script>self.__next_f.push([1,"nks/698-566acd7bad4a6521.js\"],\"name\":\"default\",\"async\":false}\nc:I{\"id\":2306,\"chunks\":[\"272:static/chunks/webpack-f8cd44685030620d.js\",\"253:static/chunks/bce60fc1-ebeb496586ce224e.js\",\"698:static/chunks/698-566acd7bad4a6521.js\"],\"name\":\"default\",\"async\":false}\n9:T518,"])</script><script>self.__next_f.push([1,"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"])</script><script>self.__next_f.push([1,"e:T518,"])</script><script>self.__next_f.push([1,"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ca7ad881d0200469.css\",\"precedence\":\"next\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"1NMnlzFgCnusFdrsIkGc_\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/2014/07/25/create-an-async-chat-server-and-client-with-dart/\",\"initialTree\":[\"\",{\"children\":[[\"year\",\"2014\",\"d\"],{\"children\":[[\"month\",\"07\",\"d\"],{\"children\":[[\"day\",\"25\",\"d\"],{\"children\":[[\"slug\",\"create-an-async-chat-server-and-client-with-dart\",\"d\"],{\"children\":[\"__PAGE__?{\\\"year\\\":\\\"2014\\\",\\\"month\\\":\\\"07\\\",\\\"day\\\":\\\"25\\\",\\\"slug\\\":\\\"create-an-async-chat-server-and-client-with-dart\\\"}\",{}]}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$L4\",null],\"globalErrorComponent\":\"$5\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800\",\"children\":[[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/atom+xml\",\"title\":\"Atom Feed for Carson's Blog\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"text-zinc-700 dark:text-zinc-100\",\"children\":[[\"$\",\"header\",null,{\"className\":\"bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600\",\"children\":[[\"$\",\"div\",null,{\"className\":\"md:max-w-screen-md px-2 md:px-0 mx-auto\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/img/avatar-new.jpg\",\"alt\":\"Avatar photo\",\"className\":\"rounded-full mx-auto md:float-right md:-mt-4\",\"width\":\"100\",\"height\":\"100\"}],[\"$\",\"div\",null,{\"className\":\"mt-5\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"mt-2\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-5xl font-bold\",\"children\":\"Carson's Blog\"}]}],[\"$\",\"p\",null,{\"className\":\"mt-2\",\"children\":\"Somewhat coherent tutorials about web stuff and things.\"}]]}]]}],[\"$\",\"$L7\",null,{}]]}],[\"$\",\"main\",null,{\"className\":\"px-4 py-2 md:p-0 md:max-w-screen-md mx-auto\",\"children\":[\"$L8\",[],[\"$\",\"div\",null,{\"className\":\"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 \",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-bold text-3xl mb-4\",\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Are you lost? There doesn't seem to be anything here\"}]]}]]}],[\"$\",\"footer\",null,{\"className\":\"mt-6 mb-6 flex items-center justify-center\",\"children\":[\"Â© Carson Evans\",\" \",[\"$\",\"$L6\",null,{\"title\":\"Github\",\"href\":\"https://github.com/carc1n0gen\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$9\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],[\"$\",\"$L6\",null,{\"title\":\"Instagram\",\"href\":\"https://www.instagram.com/carsonphotosandstuff/\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],[\"$\",\"a\",null,{\"title\":\"Atom Feed\",\"href\":\"/feed.xml\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]]}],[\"$\",\"$La\",null,{}]]}]]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"dark:bg-black md:bg-zinc-50 md:dark:bg-zinc-800\",\"children\":[[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/atom+xml\",\"title\":\"Atom Feed for Carson's Blog\",\"href\":\"/feed.xml\"}],[\"$\",\"body\",null,{\"className\":\"text-zinc-700 dark:text-zinc-100\",\"children\":[[\"$\",\"header\",null,{\"className\":\"bg-white dark:bg-black text-center md:text-left mt-5 md:mt-0 md:pt-10 border-b border-b-zinc-300 dark:border-b-zinc-600\",\"children\":[[\"$\",\"div\",null,{\"className\":\"md:max-w-screen-md px-2 md:px-0 mx-auto\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/img/avatar-new.jpg\",\"alt\":\"Avatar photo\",\"className\":\"rounded-full mx-auto md:float-right md:-mt-4\",\"width\":\"100\",\"height\":\"100\"}],[\"$\",\"div\",null,{\"className\":\"mt-5\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"mt-2\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-5xl font-bold\",\"children\":\"Carson's Blog\"}]}],[\"$\",\"p\",null,{\"className\":\"mt-2\",\"children\":\"Somewhat coherent tutorials about web stuff and things.\"}]]}]]}],[\"$\",\"$L7\",null,{}]]}],[\"$\",\"main\",null,{\"className\":\"px-4 py-2 md:p-0 md:max-w-screen-md mx-auto\",\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 \",\"children\":[[\"$\",\"h1\",null,{\"className\":\"font-bold text-3xl mb-4\",\"children\":\"Not Found\"}],[\"$\",\"p\",null,{\"children\":\"Are you lost? There doesn't seem to be anything here\"}]]}],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"year\",\"2014\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"year\",\"2014\",\"d\"],\"children\",[\"month\",\"07\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"year\",\"2014\",\"d\"],\"children\",[\"month\",\"07\",\"d\"],\"children\",[\"day\",\"25\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"year\",\"2014\",\"d\"],\"children\",[\"month\",\"07\",\"d\"],\"children\",[\"day\",\"25\",\"d\"],\"children\",[\"slug\",\"create-an-async-chat-server-and-client-with-dart\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Ld\",null],\"segment\":\"__PAGE__?{\\\"year\\\":\\\"2014\\\",\\\"month\\\":\\\"07\\\",\\\"day\\\":\\\"25\\\",\\\"slug\\\":\\\"create-an-async-chat-server-and-client-with-dart\\\"}\"},\"styles\":[]}],\"segment\":[\"slug\",\"create-an-async-chat-server-and-client-with-dart\",\"d\"]},\"styles\":[]}],\"segment\":[\"day\",\"25\",\"d\"]},\"styles\":[]}],\"segment\":[\"month\",\"07\",\"d\"]},\"styles\":[]}],\"segment\":[\"year\",\"2014\",\"d\"]},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"mt-6 mb-6 flex items-center justify-center\",\"children\":[\"Â© Carson Evans\",\" \",[\"$\",\"$L6\",null,{\"title\":\"Github\",\"href\":\"https://github.com/carc1n0gen\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$e\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],[\"$\",\"$L6\",null,{\"title\":\"Instagram\",\"href\":\"https://www.instagram.com/carsonphotosandstuff/\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],[\"$\",\"a\",null,{\"title\":\"Atom Feed\",\"href\":\"/feed.xml\",\"target\":\"_blank\",\"className\":\"ml-5\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"className\":\"inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z\",\"children\":\"$undefined\"}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]]}],[\"$\",\"$La\",null,{}]]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"13:I{\"id\":3376,\"chunks\":[\"95:static/chunks/95-564ee2c3cce6bef5.js\",\"224:static/chunks/224-a739c60a74fa69d1.js\",\"106:static/chunks/app/[year]/[month]/[day]/[slug]/page-87024f47ad3ba280.js\"],\"name\":\"\",\"async\":false}\nf:T453,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (WebsocketTransformer.isUpgradeRequest(request)) {\n  WebSocketTransformer.upgrade(request).then((WebSocket ws) {\n    connections.add(ws);\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Client connected, there are now \u003cspan class=\"hljs-subst\"\u003e${connections.length}\u003c/span\u003e client(s) connected.\u0026#x27;\u003c/span\u003e);\n    ws.listen((\u003cspan class=\"hljs-built_in\"\u003eString\u003c/span\u003e message) {\n      \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (WebSocket connection \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e connections) {\n        connection.add(message);\n      }\n    },\n    onDone: () {\n      connections.remove(ws);\n      \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Client disconnected, there are now \u003cspan class=\"hljs-subst\"\u003e${connections.legnth}\u003c/span\u003e client(s) connected.\u0026#x27;\u003c/span\u003e);\n    });\n  });\n} \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n  request.response.statusCode = HttpStatus.FORBIDDEN;\n  request.response.reasonPhrase = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Websocket connections only!\u0026#x27;\u003c/span\u003e;\n  request.response.close();\n}"])</script><script>self.__next_f.push([1,"10:T7b3,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dart:io\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e PORT = \u003cspan class=\"hljs-number\"\u003e9090\u003c/span\u003e;\n\n\u003cspan class=\"hljs-built_in\"\u003eList\u003c/span\u003e\u0026lt;WebSocket\u0026gt; connections;\n\n\u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e main() {\n  connections = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eList\u003c/span\u003e\u0026lt;WebSocket\u0026gt;();\n\n  HttpServer.bind(InternetAddress.ANY_IP_V4, PORT).then((HttpServer server) {\n    \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Server listening on port \u003cspan class=\"hljs-subst\"\u003e${PORT}\u003c/span\u003e.\u0026#x27;\u003c/span\u003e);\n    server.listen((HttpRequest request) {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (WebSocketTransformer.isUpgradeRequest(request)) {\n        WebSocketTransformer.upgrade(request).then((WebSocket ws) {\n          connections.add(ws);\n          \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Client connected, there are now \u003cspan class=\"hljs-subst\"\u003e${connections.length}\u003c/span\u003e client(s) connected.\u0026#x27;\u003c/span\u003e);\n          ws.listen((\u003cspan class=\"hljs-built_in\"\u003eString\u003c/span\u003e message) {\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (WebSocket connection \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e connections) {\n              connection.add(message);\n            }\n          },\n          onDone: () {\n            connections.remove(ws);\n            \u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Client disconnected, there are now \u003cspan class=\"hljs-subst\"\u003e${connections.length}\u003c/span\u003e client(s) connected.\u0026#x27;\u003c/span\u003e);\n          });\n        });\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        request.response.statusCode = HttpStatus.FORBIDDEN;\n        request.response.reasonPhrase = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Websocket connections only!\u0026#x27;\u003c/span\u003e;\n        request.response.close();\n      }\n    });\n  });\n}"])</script><script>self.__next_f.push([1,"11:T854,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003eChatClient\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eh1\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;nickname\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;savenickname\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eSave\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;output\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etextarea\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;input\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etextarea\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;send\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eSend\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebutton\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/dart\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;chatclient.dart\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;packages/browser/dart.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e"])</script><script>self.__next_f.push([1,"12:T7c6,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dart:html\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e main() {\n  InputElement nickname = \u003cspan class=\"hljs-built_in\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#nickname\u0026#x27;\u003c/span\u003e);\n  DivElement output = \u003cspan class=\"hljs-built_in\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#output\u0026#x27;\u003c/span\u003e);\n  TextAreaElement input = \u003cspan class=\"hljs-built_in\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#input\u0026#x27;\u003c/span\u003e);\n  ButtonElement send = \u003cspan class=\"hljs-built_in\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#send\u0026#x27;\u003c/span\u003e);\n  ButtonElement savenickname = \u003cspan class=\"hljs-built_in\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#savenickname\u0026#x27;\u003c/span\u003e);\n  WebSocket ws = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e WebSocket(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;ws://localhost:9090\u0026#x27;\u003c/span\u003e);\n\n  savenickname.onClick.listen((MouseEvent event) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (nickname.value != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e) {\n      nickname.readOnly = \u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e;\n    }\n  });\n\n  send.onClick.listen((MouseEvent event) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (nickname.value != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e \u0026amp;\u0026amp; nickname.readOnly) {\n      \u003cspan class=\"hljs-built_in\"\u003eString\u003c/span\u003e message = input.value;\n      input.value = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e;\n      input.focus();\n      ws.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u003cspan class=\"hljs-subst\"\u003e${nickname.value}\u003c/span\u003e: \u003cspan class=\"hljs-subst\"\u003e${message}\u003c/span\u003e\u0026quot;\u003c/span\u003e);\n    }\n  });\n\n  ws.addEventListener(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;message\u0026#x27;\u003c/span\u003e, (event) {\n    Message msg = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Message.FromJson(event.data);\n    output.innerHtml += \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026lt;p\u0026gt;\u003cspan class=\"hljs-subst\"\u003e${message}\u003c/span\u003e\u0026lt;/p\u0026gt;\u0026#x27;\u003c/span\u003e;\n  });\n}"])</script><script>self.__next_f.push([1,"d:[\"$\",\"article\",null,{\"className\":\"mt-6 md:p-6 bg-white dark:bg-black md:border border-zinc-300 dark:border-zinc-600 \",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/2014/07/25/create-an-async-chat-server-and-client-with-dart\",\"children\":[\"$\",\"h2\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":\"Create an Async Chat Server and Client With Dart\"}]}],[\"$\",\"p\",null,{\"className\":\"mb-4 text-sm text-zinc-400\",\"children\":[\"posted by \",\"Carson Evans\",\" Â·\",\" \",\"Jul 25, 2014\"]}]]}],[\"$\",\"section\",null,{\"children\":[\"Before starting this tutorial you should be familiar with my previous post about creating your first webapp in dart.  In this tutorial we are going to make two Dart projects.  The first one will be a command line application for the server, the second one will be a web application for the client.  We will be using WebSockets for communication between server and client.\",\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold mt-6 mb-2\",\"children\":\"Creating the server\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"Open up the Dart IDE and start a new project. Name it ChatServer and pick the \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"Command-line application\"}],\" template. A command line application means this project has no GUI, it just runs in the command prompt or terminal. The default command line application has a bin folder with one main script that acts as the entry point for the application. The script should look something like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-keyword\\\"\u003evoid\u003c/span\u003e main() {\\n  \u003cspan class=\\\"hljs-built_in\\\"\u003eprint\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;Hello, World!\u0026quot;\u003c/span\u003e);\\n}\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Above the main function we need to add an import, create a constant to hold the port the server will listen too, and create a list to hold web socket connections:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-keyword\\\"\u003eimport\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;dart:io\u0026#x27;\u003c/span\u003e;\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e \u003cspan class=\\\"hljs-built_in\\\"\u003eint\u003c/span\u003e PORT = \u003cspan class=\\\"hljs-number\\\"\u003e9090\u003c/span\u003e;\\n\\n\u003cspan class=\\\"hljs-built_in\\\"\u003eList\u003c/span\u003e\u0026lt;WebSocket\u0026gt; connections;\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"In Dart, to make a websocket server you make a http server and \",[\"$\",\"em\",null,{\"children\":\"transform\"}],\" it into a websocket server. Delete the contents of the main function, initialize the connections list, and bind an http server using the constant we made earlier as the port number:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-keyword\\\"\u003eimport\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;dart:io\u0026#x27;\u003c/span\u003e;\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e \u003cspan class=\\\"hljs-built_in\\\"\u003eint\u003c/span\u003e PORT = \u003cspan class=\\\"hljs-number\\\"\u003e9090\u003c/span\u003e;\\n\\n\u003cspan class=\\\"hljs-built_in\\\"\u003eList\u003c/span\u003e\u0026lt;WebSocket\u0026gt; connections;\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003evoid\u003c/span\u003e main() {\\n  connections = \u003cspan class=\\\"hljs-keyword\\\"\u003enew\u003c/span\u003e \u003cspan class=\\\"hljs-built_in\\\"\u003eList\u003c/span\u003e\u0026lt;WebSocket\u0026gt;();\\n\\n  HttpServer.bind(InternetAddress.ANY_UP_V4, PORT).then((HttpServer server) {\\n    \u003cspan class=\\\"hljs-built_in\\\"\u003eprint\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;Server listening on port \u003cspan class=\\\"hljs-subst\\\"\u003e${PORT}\u003c/span\u003e.\u0026#x27;\u003c/span\u003e);\\n  });\\n}\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"This syntax might look a little strange to people not familiar Dart or asynchronous programming. The \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"bind\"}],\" method of the HttpServer class is asynchronous and will return an instance of a HttpServer some time in the future. All asynchronous methods in Dart act this way and have a \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"then\"}],\" method that is called when they are done. You provide the \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"then\"}],\" method with a callback that accepts the type returned by the asynchronous method. This callback is executed when the asynchronous method is complete and the \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"then\"}],\" method is run. In our case, we are passing an anonymous function as a callback to the \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"then\"}],\" method, and all this callback does at this point is print what port the server is listening on.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Now lets make the http server listen for requests:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-built_in\\\"\u003eprint\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;Server listening on port \u003cspan class=\\\"hljs-subst\\\"\u003e${PORT}\u003c/span\u003e.\u0026#x27;\u003c/span\u003e);\\nserver.listen((HttpRequest request) {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (WebsocketTransformer.isUpgradeRequest(request)) {\\n    \u003cspan class=\\\"hljs-comment\\\"\u003e// Transform to websocket\u003c/span\u003e\\n  } \u003cspan class=\\\"hljs-keyword\\\"\u003eelse\u003c/span\u003e {\\n    request.response.statusCode = HttpStatus.FORBIDDEN;\\n    request.response.reasonPhrase = \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;Websocket connections only!\u0026#x27;\u003c/span\u003e;\\n    request.response.close();\\n  }\\n});\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Here we are checking if the request is a websocket request and if it is not then we send the client connecion an error message. Next we will do the websocket work.\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"$f\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Here we transform the request to a websocket connection and add it to our list of connections. Then we listen for messages coming from the websocket connection and send that message to every connection in the list of connections.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"The complete code should look like this:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"$10\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"You can now run this project, but it doesn't do anything because there is no client to connect with\"}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold mt-6 mb-2\",\"children\":\"Creating the client\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"Start another new project with the name ChatClient with the \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"Web application\"}],\" template. In Dart web applications have a web folder where everything will go. By default there will be a html, css, and dart file. Open up the html file and delete everything inside the body tags then add the following:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"$11\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"The first input is where you will enter your nickname with a button that saves it. Then there is a \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"div\"}],\" that will be used for do display chat messages, a \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"textarea\"}],\" for chat input, and a send button for sending message to the server. At the end there is two script references.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"The first script reference is the main Dart script for the web application and is where we will be coding our logic. The second script is a special script used to detect if the web browser supports Dart or not and will fallback to the JavaScript compiled version of the web app.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Open up the css file and delete everything and add the following:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-selector-id\\\"\u003e#output\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-attribute\\\"\u003ewidth\u003c/span\u003e: \u003cspan class=\\\"hljs-number\\\"\u003e600px\u003c/span\u003e;\\n  \u003cspan class=\\\"hljs-attribute\\\"\u003eheight\u003c/span\u003e: \u003cspan class=\\\"hljs-number\\\"\u003e400px\u003c/span\u003e;\\n  \u003cspan class=\\\"hljs-attribute\\\"\u003emargin\u003c/span\u003e: \u003cspan class=\\\"hljs-number\\\"\u003e0\u003c/span\u003e auto;\\n}\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Open up the Dart script and delete everything below the main function and inside the main function. Above the main function add an import for DOM support:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-keyword\\\"\u003eimport\u003c/span\u003e \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;dart:html\u0026#x27;\u003c/span\u003e;\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"Inside the main function we need to select the elements we need with \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"querySelector\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"hljs-keyword\\\"\u003evoid\u003c/span\u003e main() {\\n  InputElement nickname = \u003cspan class=\\\"hljs-built_in\\\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;#nickname\u0026#x27;\u003c/span\u003e);\\n  DivElement output = \u003cspan class=\\\"hljs-built_in\\\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;#output\u0026#x27;\u003c/span\u003e);\\n  TextAreaElement input = \u003cspan class=\\\"hljs-built_in\\\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;#input\u0026#x27;\u003c/span\u003e);\\n  ButtonElement send = \u003cspan class=\\\"hljs-built_in\\\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;#send\u0026#x27;\u003c/span\u003e);\\n  ButtonElement savenickname = \u003cspan class=\\\"hljs-built_in\\\"\u003equerySelector\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;#savenickname\u0026#x27;\u003c/span\u003e);\\n}\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Next create a WebSocket connection:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"WebSocket ws = \u003cspan class=\\\"hljs-keyword\\\"\u003enew\u003c/span\u003e WebSocket(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;ws://localhost:9090\u0026#x27;\u003c/span\u003e);\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Now when the save nickname button is clicked we need to make the nickname field read only.\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"savenickname.onClick.listen((MouseEvent event) {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (nickname.value != \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e) {\\n    nickname.readOnly = \u003cspan class=\\\"hljs-keyword\\\"\u003etrue\u003c/span\u003e;\\n  }\\n});\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Then we make the send button actually send the contents of the input to the server. We only want to send the message if the nickname is read only (has been saved) and the input isnt empty:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"send.onClick.listen((MouseEvent event) {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (nickname.value != \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e \u0026amp;\u0026amp; nickname.readOnly) {\\n    \u003cspan class=\\\"hljs-built_in\\\"\u003eString\u003c/span\u003e message = input.value;\\n    input.value = \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e;\\n    input.focus();\\n    ws.send(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026quot;\u003cspan class=\\\"hljs-subst\\\"\u003e${nickname.value}\u003c/span\u003e: \u003cspan class=\\\"hljs-subst\\\"\u003e${message}\u003c/span\u003e\u0026quot;\u003c/span\u003e);\\n  }\\n});\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"Finally we need to listen to the connection to the server for messages to display in the output \",[\"$\",\"code\",null,{\"className\":\"font-bold\",\"children\":\"div\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"ws.addEventListener(\u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;message\u0026#x27;\u003c/span\u003e, (event) {\\n  \u003cspan class=\\\"hljs-built_in\\\"\u003eString\u003c/span\u003e message = event.data;\\n  output.innerHtml += \u003cspan class=\\\"hljs-string\\\"\u003e\u0026#x27;\u0026lt;p\u0026gt;\u003cspan class=\\\"hljs-subst\\\"\u003e${message}\u003c/span\u003e\u0026lt;/p\u0026gt;\u0026#x27;\u003c/span\u003e;\\n});\"}}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Here is the complete code:\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"my-4 -mx-4 md:-mx-[24px]\",\"children\":[\"$\",\"code\",null,{\"className\":\"hljs bg-zinc-100 dark:bg-zinc-700\",\"dangerouslySetInnerHTML\":{\"__html\":\"$12\"}}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-2xl font-bold mt-6 mb-2\",\"children\":\"Conclusion\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Now you can run the chat server, then run the chat client. Enter a nickname, enter a message and click send. You should then see your message. You can copy the url for the chat client and open multiple tabs and go to that url. Each tab will count as a new connection to the server so they can all talk to each other.\"}]]}],[\"$\",\"footer\",null,{\"className\":\"mt-6\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-4 text-sm text-zinc-400\",\"children\":[\"Updated\",\" \",\"Sep 15, 2023\"]}],[\"$\",\"$L13\",null,{\"title\":\"Create an Async Chat Server and Client With Dart\",\"postUrl\":\"/2014/07/25/create-an-async-chat-server-and-client-with-dart\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"8:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Create an Async Chat Server and Client With Dart - Carson's Blog\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Before starting this tutorial you should be familiar with my previous post about creating your first webapp in dart.  In this tutorial we are going to make two Dart projects.  The first one will be a command line application for the server, the second one will be a web application for the client.  We will be using WebSockets for communication between server and client.\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"chat async dart\"}],[\"$\",\"meta\",\"4\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]]\n"])</script></body></html>